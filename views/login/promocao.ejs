<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tela de Promoções</title>

  <!-- Bootstrap 4.1.3 -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
    integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
    integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>

  <!-- Seu CSS -->
  <link rel="stylesheet" href="/style/style.css" />
</head>

<body class="fundo-amarelo">
  <div class="container mt-4">
    <!-- Logo -->
    <div class="text-left mb-4">
      <img src="../img/logoRes.png" alt="Logo Sabor Caseiro" style="width: 200px; height: auto;">
    </div>

    <div class="row">
      <!-- Formulário -->
      <div class="col-md-6">
        <h2>Criar Promoção</h2>
        <form id="formPromocao">
          <div class="form-group">
            <label>Nome da Promoção</label>
            <input name="nome_promocao" type="text" class="form-control" placeholder="Ex: Combo Verão" required>
          </div>

          <div class="form-group">
            <label>Descrição</label>
            <input type="text" name="descricao" class="form-control" placeholder="Detalhes da promoção..." required>
          </div>

          <div class="form-group">
            <label>Quantidade de refeições para valer</label>
            <input type="number" name="qtd_refeicoes" class="form-control" placeholder="Ex: 10" min="0">
          </div>

          <div class="form-group">
            <label>Tipo de desconto:</label>
            <select name="tipo_desconto" class="form-control">
              <option value="porcentual">Desconto porcentual (%)</option>
              <option value="fixo">Fixo (R$)</option>
              <option value="metaCompras">Gastando R$ ganhe mais 1</option>
            </select>
          </div>

          <div class="form-group">
            <label>Valor do desconto</label>
            <input type="number" name="valor_desconto" class="form-control" step="0.01">
          </div>

          <div class="form-group">
            <label>Data de início:</label>
            <input type="date" name="data_inicio" class="form-control">
          </div>

          <div class="form-group">
            <label>Data de término:</label>
            <input type="date" name="data_termino" class="form-control">
          </div>

          <div class="form-group">
            <label>Imagem da promoção (opcional):</label>
            <input type="file" name="imagem_promocao" class="form-control-file">
          </div>

          <button type="submit" class="btn btn-success btn-block">Salvar Promoção</button>
        </form>
      </div>

      <!-- Tabela -->
      <div class="col-md-6">
        <h2>Promoções Vigentes</h2>
        <table class="table table-bordered table-striped">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Descrição</th>
              <th>Validade</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody id="tabelaPromocoes">
            <tr>
              <td>Combo Verão</td>
              <td>Desconto de 20% na segunda refeição do dia</td>
              <td>Até 30/09/2025</td>
              <td>
                <div class="d-flex justify-content-between">
                  <button class="btn btn-warning btn-sm w-100 mr-2" onclick="estenderPromocao(this)">Estender</button>
                  <button class="btn btn-info btn-sm w-100 mr-2" onclick="editarPromocao(this)">Editar</button>
                  <button class="btn btn-danger btn-sm w-100" onclick="excluirPromocao(this)">Excluir</button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Lógica dos botões -->
  <script>
    document.getElementById("formPromocao").addEventListener("submit", function (e) {
      e.preventDefault();

      const nome = this.nome_promocao.value.trim();
      const descricao = this.descricao.value.trim();
      const dataTermino = this.data_termino.value;



      if (nome && descricao && dataTermino) {
        const tabela = document.getElementById("tabelaPromocoes");
        const novaLinha = document.createElement("tr");

        novaLinha.innerHTML = `
          <td>${nome}</td>
          <td>${descricao}</td>
          <td>Até ${dataTermino}</td>
          <td>
            <div class="d-flex justify-content-between">
              <button class="btn btn-warning btn-sm w-100 mr-2" onclick="estenderPromocao(this)">Estender</button>
              <button class="btn btn-info btn-sm w-100 mr-2" onclick="editarPromocao(this)">Editar</button>
              <button class="btn btn-danger btn-sm w-100" onclick="excluirPromocao(this)">Excluir</button>
            </div>
          </td>
        `;

        tabela.appendChild(novaLinha);
        this.reset();
        alert("Promoção salva com sucesso!");
      } else {
        alert("Preencha os campos obrigatórios!");
      }
    });

    function excluirPromocao(botao) {
      const linha = botao.closest("tr");
      linha.remove();
    }

    function editarPromocao(botao) {
      const linha = botao.closest("tr");
      const nome = linha.children[0].textContent;
      const descricao = linha.children[1].textContent;
      const validade = linha.children[2].textContent.replace("Até ", "");

      const novoNome = prompt("Editar nome da promoção:", nome);
      const novaDescricao = prompt("Editar descrição:", descricao);
      const novaValidade = prompt("Editar validade (DD/MM/AAAA):", validade);

      if (novoNome && novaDescricao && novaValidade) {
        linha.children[0].textContent = novoNome;
        linha.children[1].textContent = novaDescricao;
        linha.children[2].textContent = "Até " + novaValidade;
      }
    }

    function estenderPromocao(botao) {
      const linha = botao.closest("tr");
      const validadeAtual = linha.children[2].textContent.replace("Até ", "");
      const novaValidade = prompt("Nova data de validade (DD/MM/AAAA):", validadeAtual);

      if (novaValidade) {
        linha.children[2].textContent = "Até " + novaValidade;
      }
    }
  </script>
</body>
</html>
