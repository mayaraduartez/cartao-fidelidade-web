<!DOCTYPE html>
<html lang="pt-br">
<head>
  <title>Promoções Cadastradas</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="/vendor/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style3.css">
  <style>
    /* ======== MELHORIAS DE ESTILO ======== */

    body {
      background: #f4f4f4;
      padding: 20px;
    }

    .logo-area img {
      width: 150px;
      display: block;
      margin: 0 auto 20px;
    }

    .titulo-promocoes {
      text-align: center;
      margin-bottom: 25px;
      font-weight: bold;
    }

    .box-formulario, .box-tabela {
      background: #fff;
      padding: 25px;
      margin-bottom: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .btn-group-form {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .input100 {
      width: 100%;
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 6px;
    }

    /* ======== BOTÕES PERSONALIZADOS ======== */

    .login100-form-btn {
      background: #007bff !important;
      border: none;
      color: #fff !important;
      padding: 10px 18px;
      border-radius: 6px;
      cursor: pointer;
    }

    .login100-form-btn:hover {
      background: #0056b3 !important;
    }

    .login100-form-btnlimpar-btn {
      background: #6c757d !important;
      border: none;
      color: #fff !important;
      padding: 10px 18px;
      border-radius: 6px;
      cursor: pointer;
    }

    .login100-form-btnlimpar-btn:hover {
      background: #545b62 !important;
    }

    /* ======== BOTÕES DA TABELA ======== */

    .btn-group-vertical .btn {
      width: 100px;
    }

    .btn-warning {
      background-color: #ffc107 !important;
      border-color: #ffc107 !important;
      color: #000 !important;
    }

    .btn-success {
      background-color: #28a245 !important;
      border-color: #28a245 !important;
    }

    .btn-danger {
      background-color: #dc3545 !important;
      border-color: #b21f2d !important;
    }
  </style>
</head>

<body class="bg-light">

  <div class="container mt-4">

    <div class="text-center mb-4">
      <img src="/images/logoRes.png" alt="Logo" style="width:150px;">
      <h1 class="mt-3">Promoções</h1>
    </div>

    <!-- FORMULÁRIO -->
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <h2 class="h5 mb-3">Buscar Promoções</h2>
        
        <form method="get" action="/login/promocoes/buscar">
          <input type="number" name="id" class="form-control mb-2" placeholder="Buscar por ID">
          <input type="text" name="nome" class="form-control mb-3" placeholder="Buscar por nome">

          <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary">Buscar</button>
            <button type="button" class="btn btn-secondary" onclick="voltarFiltros()">Voltar</button>
          </div>
        </form>
      </div>
    </div>

    <!-- TABELA -->
    <div class="card shadow-sm">
      <div class="card-body">
        <h2 class="h5 mb-3">Promoções Cadastradas</h2>

        <div class="table-responsive">
          <table class="table table-striped table-bordered text-center align-middle">
            <thead class="table-dark">
              <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>Descrição</th>
                <th>Foto</th>
                <th>Quantidade</th>
                <th>Tipo Desconto</th>
                <th>Valor</th>
                <th>Data Início</th>
                <th>Data Fim</th>
                <th>Ações</th>
              </tr>
            </thead>

            <tbody>
              <% promocoes.forEach(promo => { %>
                <tr>
                  <td><%= promo.id %></td>
                  <td><%= promo.nome %></td>
                  <td><%= promo.descricao %></td>

                  <td>
                    <% if (promo.foto) { %>
                      <img src="/uploads/<%= promo.foto %>" class="rounded" style="width:50px; height:50px; object-fit:cover;">
                    <% } else { %>
                      —
                    <% } %>
                  </td>

                  <td><%= promo.qtd_refeicao %></td>
                  <td><%= promo.tipo_desconto %></td>
                  <td>R$ <%= promo.valor %></td>

                  <td><%= new Date(promo.data_inicio).toLocaleDateString('pt-BR') %></td>
                  <td><%= promo.data_fim ? new Date(promo.data_fim).toLocaleDateString('pt-BR') : '—' %></td>

                  <td>
                    <div class="btn-group-vertical">
                     
                      
                      <button class="btn btn-danger btn-sm" onclick="excluirPromocao(<%= promo.id %>)">Excluir</button>
                      

                      <button type="button" class="btn btn-secondary" onclick="editar(<%= promo.id %>)">Editar</button>

                    </div>
                  </td>
                </tr>
              <% }) %>
            </tbody>

          </table>
        </div>
      </div>
    </div>
  </div>

<script>
  function voltarFiltros() {
    window.location.href = "/listarPromocoes"; // volta para os filtros
  }
  
  function editar(id) {
    window.location.href = "/login/telaEditarPromocao/" + id + "/editar";
  }

  function excluirPromocao(id) {
  if (confirm('Excluir?')) {
    fetch('/login/listarPromocoes/excluirPromocao/' + id, {
      method: 'POST'
    }).then(() => location.reload());
  }
}


</script>
</body>
</html>
